(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{l5K6:function(e,t,r){(function(e){!function(t,r,n,a,o,s,i,c,u,h,d,l,f,p,y,v,w,g,m,k,x,S,P,K,b){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a,o=o&&o.hasOwnProperty("default")?o.default:o,s=s&&s.hasOwnProperty("default")?s.default:s,i=i&&i.hasOwnProperty("default")?i.default:i,u=u&&u.hasOwnProperty("default")?u.default:u,h=h&&h.hasOwnProperty("default")?h.default:h,d=d&&d.hasOwnProperty("default")?d.default:d,l=l&&l.hasOwnProperty("default")?l.default:l,f=f&&f.hasOwnProperty("default")?f.default:f,p=p&&p.hasOwnProperty("default")?p.default:p,y=y&&y.hasOwnProperty("default")?y.default:y,v=v&&v.hasOwnProperty("default")?v.default:v,w=w&&w.hasOwnProperty("default")?w.default:w,k=k&&k.hasOwnProperty("default")?k.default:k,x=x&&x.hasOwnProperty("default")?x.default:x,S=S&&S.hasOwnProperty("default")?S.default:S,P=P&&P.hasOwnProperty("default")?P.default:P;var E=function(e){function t(e,r){var n;return a(this,t),(n=o(this,s(t).call(this,e,r))).methods={getChainId:c.ChainIdMethod,getGasPrice:c.GetGasPriceMethod,getTransactionCount:c.GetTransactionCountMethod},n}return i(t,e),t}(c.AbstractMethodFactory),O=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(this,t),this.address=e.address,this.privateKey=e.privateKey,this.accounts=r}return d(t,[{key:"signTransaction",value:function(e,t){return this.accounts.signTransaction(e,this.privateKey,t)}},{key:"sign",value:function(t){r.isHexStrict(t)&&(t=r.hexToBytes(t));var n=e.from(t),a="Ethereum Signed Message:\n".concat(t.length),o=e.from(a),s=e.concat([o,n]),i=y.keccak256s(s),c=g.sign(i,this.privateKey),u=g.decodeSignature(c);return{message:t,messageHash:i,v:u[0],r:u[1],s:u[2],signature:c}}},{key:"encrypt",value:function(e,r){return t.fromPrivateKey(this.privateKey,this.accounts).toV3Keystore(e,r)}},{key:"toV3Keystore",value:function(t,n){var a,o=(n=n||{}).salt||P(32),s=n.iv||P(16),i=n.kdf||"scrypt",c={dklen:n.dklen||32,salt:o.toString("hex")};if("pbkdf2"===i)c.c=n.c||262144,c.prf="hmac-sha256",a=K.pbkdf2Sync(e.from(t),o,c.c,c.dklen,"sha256");else{if("scrypt"!==i)throw new Error("Unsupported kdf");c.n=n.n||8192,c.r=n.r||8,c.p=n.p||1,a=k(e.from(t),o,c.n,c.r,c.p,c.dklen)}var u=b.createCipheriv(n.cipher||"aes-128-ctr",a.slice(0,16),s);if(!u)throw new Error("Unsupported cipher");var h=e.concat([u.update(e.from(this.privateKey.replace("0x",""),"hex")),u.final()]),d=r.keccak256(e.concat([a.slice(16,32),e.from(h,"hex")])).replace("0x","");return{version:3,id:S.v4({random:n.uuid||P(16)}),address:this.address.toLowerCase().replace("0x",""),crypto:{ciphertext:h.toString("hex"),cipherparams:{iv:s.toString("hex")},cipher:n.cipher||"aes-128-ctr",kdf:i,kdfparams:c,mac:d.toString("hex")}}}}],[{key:"from",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new t(g.create(e||r.randomHex(32)),n)}},{key:"fromPrivateKey",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new t(g.fromPrivate(e),r)}},{key:"fromV3Keystore",value:function(n,a){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!x(a))throw new Error("No password given.");var i,c,u=p(n)?n:JSON.parse(o?n.toLowerCase():n);if(3!==u.version)throw new Error("Not a valid V3 wallet");if("scrypt"===u.crypto.kdf)c=u.crypto.kdfparams,i=k(e.from(a),e.from(c.salt,"hex"),c.n,c.r,c.p,c.dklen);else{if("pbkdf2"!==u.crypto.kdf)throw new Error("Unsupported key derivation scheme");if("hmac-sha256"!==(c=u.crypto.kdfparams).prf)throw new Error("Unsupported parameters to PBKDF2");i=K.pbkdf2Sync(e.from(a),e.from(c.salt,"hex"),c.c,c.dklen,"sha256")}var h=e.from(u.crypto.ciphertext,"hex"),d=r.keccak256(e.concat([i.slice(16,32),h])).replace("0x","");if(d!==u.crypto.mac)throw new Error("Key derivation failed - possibly wrong password");var l=b.createDecipheriv(u.crypto.cipher,i.slice(0,16),e.from(u.crypto.cipherparams.iv,"hex")),f="0x".concat(e.concat([l.update(h),l.final()]).toString("hex"));return t.fromPrivateKey(f,s)}}]),t}(),I=function(){function e(t,r){return a(this,e),this.utils=t,this.accountsModule=r,this.defaultKeyName="web3js_wallet",this.accounts={},this.accountsIndex=0,new Proxy(this,{get:function(e,t){return e.accounts[t]?e.accounts[t]:"length"===t?e.accountsIndex:e[t]}})}return d(e,[{key:"create",value:function(e,t){for(var r=0;r<e;++r)this.add(O.from(t||this.utils.randomHex(32),this.accountsModule));return this}},{key:"get",value:function(e){return this.accounts[e]}},{key:"add",value:function(e){return x(e)&&(e=O.fromPrivateKey(e,this.accountsModule)),this.accounts[e.address]?this.accounts[e.address]:(this.accounts[this.accountsIndex]=e,this.accounts[e.address]=e,this.accounts[e.address.toLowerCase()]=e,this.accountsIndex++,e)}},{key:"remove",value:function(e){var t=this.accounts[e];return!!t&&(delete this.accounts[t.address],delete this.accounts[t.address.toLowerCase()],delete this.accounts[t.index],!0)}},{key:"clear",value:function(){for(var e=0;e<=this.accountsIndex;e++)this.remove(e);return this.accountsIndex=0,this}},{key:"encrypt",value:function(e,t){for(var r=[],n=0;n<this.accountsIndex;n++)r.push(this.accounts[n].encrypt(e,t));return r}},{key:"decrypt",value:function(e,t){var r=this;return e.forEach(function(e){var n=O.fromV3Keystore(e,t,!1,r.accountsModule);if(!n)throw new Error("Couldn't decrypt accounts. Password wrong?");r.add(n)}),this}},{key:"save",value:function(e,t){if(console.warn("SECURITY WARNING: Storing of accounts in the localStorage is highly insecure!"),"undefined"==typeof localStorage)throw new TypeError("window.localStorage is undefined.");try{localStorage.setItem(t||this.defaultKeyName,JSON.stringify(this.encrypt(e)))}catch(e){if(18===e.code)return!0;throw new Error(e)}return!0}},{key:"load",value:function(e,t){if(console.warn("SECURITY WARNING: Storing of accounts in the localStorage is highly insecure!"),"undefined"==typeof localStorage)throw new TypeError("window.localStorage is undefined.");var r;try{(r=localStorage.getItem(t||this.defaultKeyName))&&(r=JSON.parse(r))}catch(e){if(18!==e.code)throw new Error(e);r=this.defaultKeyName}return this.decrypt(r||[],e)}}]),e}(),N=function(t){function r(e,t,n,i,c,u){var h;return a(this,r),(h=o(this,s(r).call(this,e,c,i,u))).utils=t,h.formatters=n,h._transactionSigner=c.transactionSigner,h.defaultKeyName="web3js_wallet",h.accounts={},h.accountsIndex=0,h.wallet=new I(t,l(h)),h}return i(r,t),d(r,[{key:"create",value:function(e){return O.from(e,this)}},{key:"privateKeyToAccount",value:function(e){return O.fromPrivateKey(e,this)}},{key:"hashMessage",value:function(t){this.utils.isHexStrict(t)&&(t=this.utils.hexToBytes(t));var r=e.from(t),n=e.from("Ethereum Signed Message:\n".concat(t.length)),a=e.concat([n,r]);return y.keccak256s(a)}},{key:"signTransaction",value:(n=h(u.mark(function e(t,r,n){var a,o;return u.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,a=O.fromPrivateKey(r,this),t.chainId){e.next=6;break}return e.next=5,this.getChainId();case 5:t.chainId=e.sent;case 6:if(t.gasPrice){e.next=10;break}return e.next=9,this.getGasPrice();case 9:t.gasPrice=e.sent;case 10:if(t.nonce||0===t.nonce){e.next=14;break}return e.next=13,this.getTransactionCount(a.address);case 13:t.nonce=e.sent;case 14:return e.next=16,this.transactionSigner.sign(this.formatters.inputCallFormatter(t,this),a.privateKey);case 16:return o=e.sent,f(n)&&n(!1,o),e.abrupt("return",o);case 21:if(e.prev=21,e.t0=e.catch(0),!f(n)){e.next=26;break}return n(e.t0,null),e.abrupt("return");case 26:throw e.t0;case 27:case"end":return e.stop()}},e,this,[[0,21]])})),function(e,t,r){return n.apply(this,arguments)})},{key:"recoverTransaction",value:function(e){var t=v.decode(e),r=g.encodeSignature(t.slice(6,9)),n=w.toNumber(t[6]),a=n<35?[]:[w.fromNumber(n-35>>1),"0x","0x"],o=t.slice(0,6).concat(a),s=v.encode(o);return g.recover(y.keccak256(s),r)}},{key:"sign",value:function(e,t){return this.utils.isHexStrict(e)&&(e=this.utils.hexToBytes(e)),O.fromPrivateKey(t,this).sign(e)}},{key:"recover",value:function(e,t,r){return p(e)?this.recover(e.messageHash,g.encodeSignature([e.v,e.r,e.s]),!0):(r||(e=this.hashMessage(e)),arguments.length>=4?this.recover(arguments[0],g.encodeSignature([arguments[1],arguments[2],arguments[3]]),!!arguments[4]):g.recover(e,t))}},{key:"decrypt",value:function(e,t,r){return O.fromV3Keystore(e,t,r,this)}},{key:"encrypt",value:function(e,t,r){return O.fromPrivateKey(e,this).toV3Keystore(t,r)}},{key:"transactionSigner",get:function(){return this._transactionSigner},set:function(e){if(e.type&&"TransactionSigner"===e.type)throw new Error("Invalid TransactionSigner given!");this._transactionSigner=e}}]),r;var n}(m.AbstractWeb3Module);t.Accounts=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new N(e,r,n.formatters,new E(r,n.formatters),a,t)},Object.defineProperty(t,"__esModule",{value:!0})}(t,r("9eBz"),r("4vD9"),r("lwsE"),r("a1gu"),r("Nsbk"),r("7W2i"),r("s9tM"),r("o0o1"),r("yXPU"),r("W8MJ"),r("PJYZ"),r("lSCD"),r("GoyQ"),r("ewvk"),r("2YU9"),r("c/MD"),r("b/S+"),r("K9+5"),r("U4kA"),r("4qC0"),r("EcEN"),r("Edxu"),r("oJl4"),r("lWpZ"))}).call(this,r("tjlA").Buffer)}}]);